<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Captcha Storm</title>
<style>
  :root { --bg: #0f1220; --card: #1e1b2b; --accent: #7bd389; --muted: #9aa4b4; --white: #fff; --grid-gap: 12px; }
  * { box-sizing: border-box; }
  html, body { height: 100%; margin: 0; font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial; background: radial-gradient(circle at 20% -10%, rgba(123,211,137,0.25), transparent 40%), radial-gradient(circle at 90% 10%, rgba(110,140,255,0.25), transparent 40%), #0b0a12; color: #e9e9e9; }
  .app { min-height: 100%; display: flex; flex-direction: column; }
  .header { position: sticky; top: 0; z-index: 10; padding: 14px; display: flex; align-items: center; justify-content: space-between; background: rgba(10,10,20,0.9); backdrop-filter: saturate(1.2) blur(6px); border-bottom: 1px solid rgba(255,255,255,0.05); }
  .title { font-size: 1.25rem; font-weight: 700; letter-spacing: .4px; display: flex; gap: 10px; align-items: center; }
  .badge { padding: 6px 10px; border-radius: 999px; background: #1b1f2a; color: #a8f0d2; font-weight: 600; font-size: 12px; }
  .stats { display: flex; align-items: center; gap: 12px; }
  .btn { appearance: none; border: none; background: #6c6cff; color: white; padding: 10px 14px; border-radius: 10px; cursor: pointer; font-weight: 600; transition: transform 0.1s ease, background 0.3s ease; }
  .btn.secondary { background: #2a2f44; color: #e9eeff; }
  .btn:active { transform: scale(0.98); }
  .grid { padding: 14px; display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: var(--grid-gap); align-items: stretch; }
  .card { background: linear-gradient(135deg, rgba(255,255,255,0.05), rgba(255,255,255,0.02)); border: 1px solid rgba(255,255,255,0.08); border-radius: 14px; padding: 14px; display: flex; flex-direction: column; gap: 10px; min-height: 180px; position: relative; overflow: hidden; transition: transform 0.2s ease, opacity 0.25s ease; }
  .card:hover { transform: translateY(-2px); }
  .card.solved { opacity: 0.4; }
  .question { font-size: 14px; color: #e8eaf6; }
  .choices { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
  .option { padding: 8px 10px; border-radius: 8px; border: 1px solid rgba(255,255,255,0.2); background: #252a3a; color: #fff; cursor: pointer; font-weight: 600; transition: transform 0.1s ease, background 0.2s; }
  .option:hover { transform: translateY(-1px); background: #2e324a; }
  .option.correct { background: #1e7f54; border-color: #2ddc93; }
  .option.incorrect { background: #8b2c2c; border-color: #e05a5a; }
  .meta { font-size: 11px; color: #cbd5e1; display: flex; justify-content: space-between; align-items: center; }
  .index { position: absolute; top: 8px; right: 10px; font-size: 11px; color: #9aa4b2; }

  .overlay { position: fixed; inset: 0; display: none; align-items: center; justify-content: center; background: rgba(0,0,0,0.6); z-index: 20; }
  .overlay.active { display: flex; }
  .modal { background: #111521; border-radius: 14px; padding: 28px; text-align: center; max-width: 420px; width: calc(100% - 40px); box-shadow: 0 20px 40px rgba(0,0,0,0.4); }
  .modal h2 { margin: 0 0 8px; font-size: 1.6rem; }
  .modal p { color: #dbe7ff; margin: 0 0 14px; }
  .confetti-canvas { position: fixed; pointer-events: none; left: 0; top: 0; width: 100%; height: 100%; z-index: 30; }

  @keyframes shake { 0%{ transform: translateX(0); } 25%{ transform: translateX(-6px);} 50%{ transform: translateX(6px);} 75%{ transform: translateX(-4px);} 100%{ transform: translateX(0);} }

  @media (max-width: 700px) {
    .header { flex-direction: column; align-items: stretch; gap: 8px; padding: 12px; }
    .stats { justify-content: space-between; }
  }
</style>
</head>
<body>
<div class="app">
  <header class="header">
    <div class="title">
      <span>Captcha Storm</span>
      <span class="badge" title="50 challenges to solve">50 CAPTCHAs</span>
    </div>
    <div class="stats">
      <span class="badge" id="remainingBadge" title="Remaining challenges">Remaining: 50</span>
      <span class="badge" id="solvedBadge" title="Solved count">Solved: 0</span>
      <button id="resetBtn" class="btn" title="Reset">Reset</button>
    </div>
  </header>

  <main class="grid" id="grid" aria-label="Captcha grid">
    <!-- Cards generated by JS -->
  </main>
</div>

<canvas id="confetti" class="confetti-canvas" aria-hidden="true"></canvas>

<div id="overlay" class="overlay" aria-hidden="true" role="dialog" aria-label="All CAPTCHAs solved">
  <div class="modal">
    <h2>All CAPTCHAs solved!</h2>
    <p>You endured the CAPTCHA storm. Great job defeating the 50 verifications.</p>
    <button id="againBtn" class="btn" autofocus>Play again</button>
  </div>
</div>

<script>
(function(){
  const TOTAL = 50;
  const grid = document.getElementById('grid');
  const remainingBadge = document.getElementById('remainingBadge');
  const solvedBadge = document.getElementById('solvedBadge');
  const resetBtn = document.getElementById('resetBtn');
  const overlay = document.getElementById('overlay');
  const againBtn = document.getElementById('againBtn');
  const confCanvas = document.getElementById('confetti');
  const ctx = confCanvas.getContext('2d');
  let confettiActive = false;
  let confettiList = [];

  function randInt(a,b){ return Math.floor(Math.random()*(b-a+1))+a; }
  function shuffle(a){ for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; } return a; }

  function createCard(index){
    const a = randInt(1,9);
    const b = randInt(1,9);
    const correct = a + b;
    let options = new Set([correct]);
    while(options.size<4){
      options.add(randInt(2, 18));
    }
    options = Array.from(options);
    shuffle(options);

    const card = document.createElement('article');
    card.className = 'card';
    card.setAttribute('data-index', index);

    const idx = document.createElement('span');
    idx.className = 'index';
    idx.textContent = String(index+1).padStart(2,'0');
    card.appendChild(idx);

    const q = document.createElement('div');
    q.className = 'question';
    q.textContent = `What is ${a} + ${b}?`;
    card.appendChild(q);

    const choices = document.createElement('div');
    choices.className = 'choices';
    options.forEach(val=>{
      const btn = document.createElement('button');
      btn.className = 'option';
      btn.textContent = val;
      btn.setAttribute('data-value', val);
      btn.addEventListener('click', function(){
        if(card.classList.contains('solved')) return;
        const isCorrect = Number(btn.getAttribute('data-value')) === correct;
        if(isCorrect){
          btn.classList.add('correct');
          card.classList.add('solved');
          const mark = document.createElement('span');
          mark.textContent = 'âœ“';
          mark.style.position='absolute';
          mark.style.right='10px';
          mark.style.top='8px';
          mark.style.fontSize='14px';
          mark.style.color='#1bd98e';
          card.appendChild(mark);
          const allOpts = card.querySelectorAll('.option');
          allOpts.forEach(o => o.disabled = true);
          solvedCountInc();
        } else {
          btn.classList.add('incorrect');
          card.style.animation = 'shake 0.25s';
          setTimeout(()=>{ card.style.animation=''; }, 250);
        }
      });
      choices.appendChild(btn);
    });

    card.appendChild(choices);
    grid.appendChild(card);
    return card;
  }

  function solvedCountInc(){
    let s = parseInt(solvedBadge.textContent.replace(/\D/g,''),10);
    s = isNaN(s) ? 0 : s;
    s += 1;
    solvedBadge.textContent = 'Solved: ' + s;
    const remaining = TOTAL - s;
    remainingBadge.textContent = 'Remaining: ' + remaining;
    if(remaining <= 0){
      triggerWin();
    }
  }

  function triggerWin(){
    overlay.classList.add('active');
    overlay.style.display = 'flex';
    overlay.setAttribute('aria-hidden','false');
    startConfetti();
  }

  function resetAll(){
    grid.innerHTML = '';
    solvedBadge.textContent = 'Solved: 0';
    remainingBadge.textContent = 'Remaining: ' + TOTAL;
    for(let i=0; i<TOTAL; i++){
      createCard(i);
    }
    overlay.classList.remove('active');
    overlay.style.display = 'none';
    overlay.setAttribute('aria-hidden','true');
    stopConfetti();
  }

  function startConfetti(){
    if(confettiActive) return;
    confettiActive = true;
    resizeCanvas();
    confettiList = [];
    const colors = ['#f94144','#f3722c','#f9c74f','#90be6d','#43aa8b','#577590'];
    for(let i=0; i<180; i++){
      confettiList.push({
        x: Math.random()*confCanvas.width,
        y: -Math.random()*confCanvas.height,
        r: Math.random()*6+4,
        color: colors[Math.floor(Math.random()*colors.length)],
        vy: Math.random()*2+1,
        vx: (Math.random()*2-1)*2,
        rot: Math.random()*360
      });
    }
    requestAnimationFrame(updateConfetti);
  }

  function stopConfetti(){
    confettiActive = false;
    confettiList = [];
    ctx.clearRect(0,0,confCanvas.width, confCanvas.height);
  }

  function resizeCanvas(){
    const dpr = window.devicePixelRatio || 1;
    confCanvas.width = Math.floor(window.innerWidth * dpr);
    confCanvas.height = Math.floor(window.innerHeight * dpr);
    ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
  }

  function updateConfetti(){
    if(!confettiActive) return;
    ctx.clearRect(0,0,confCanvas.width, confCanvas.height);
    for(let c of confettiList){
      c.x += c.vx;
      c.y += c.vy;
      c.rot += 2;
      if(c.x < -10) c.x = confCanvas.width + 10;
      if(c.x > confCanvas.width + 10) c.x = -10;
      if(c.y > confCanvas.height + 10){
        c.y = -10;
        c.x = Math.random()*confCanvas.width;
        c.vy = Math.random()*2+1;
      }
      ctx.save();
      ctx.translate(c.x, c.y);
      ctx.rotate(c.rot * Math.PI/180);
      ctx.fillStyle = c.color;
      ctx.fillRect(-c.r/2, -c.r/2, c.r, c.r);
      ctx.restore();
    }
    requestAnimationFrame(updateConfetti);
  }

  function init(){
    resetAll();
  }

  resetBtn.addEventListener('click', resetAll);
  againBtn.addEventListener('click', ()=>{ resetAll(); });

  window.addEventListener('resize', resizeCanvas);

  // Start
  init();

})();
</script>
</body>
</html>